/*
 * ------------------------------------------------------------
 * IMPORTANT: The contents of this file are auto-generated.
 *
 * This file may be updated by the Shopify admin theme editor
 * or related systems. Please exercise caution as any changes
 * made to this file may be overwritten.
 * ------------------------------------------------------------
 */
{
  "sections": {
    "heading": {
      "type": "heading-template",
      "settings": {
        "heading_fullwidth": false,
        "use_specify_image": true,
        "parallax": false,
        "color": "#000000",
        "overlay": 54,
        "padding": 50,
        "paddingmb": 50,
        "mg_b": 50,
        "mg_bmb": 50,
        "content_align": "t4s-text-center",
        "bg_pos": "center center",
        "bg_repeat": "no-repeat",
        "bg_size": "cover",
        "use_cus_css": false,
        "code_cus_css": ".SectionID {\nbackground-color:red\n}"
      }
    },
    "main": {
      "type": "main-page",
      "settings": {
        "layout": "t4s-container-wrap",
        "cl_bg": "",
        "cl_bg_gradient": "",
        "mg": "60px,,60px,",
        "pd": "",
        "mg_tb": "",
        "pd_tb": "",
        "mg_mb": ",,30px,",
        "pd_mb": ""
      }
    },
    "sidebar-page": {
      "type": "sidebar-page",
      "blocks": {
        "f69681ed-b75e-42de-be58-fdf73b3b7e08": {
          "type": "blog_cate",
          "settings": {
            "title": "Blog categories",
            "cat_link_list": "",
            "count": true
          }
        }
      },
      "block_order": [
        "f69681ed-b75e-42de-be58-fdf73b3b7e08"
      ],
      "disabled": true,
      "settings": {
        "enable_drawer": false,
        "space": 50,
        "size": "medium",
        "br_style": "none",
        "brcolor": "#222222",
        "sidebar_bdr": 5,
        "sidebar_pd": 10
      }
    },
    "custom_liquid_CX46ap": {
      "type": "custom-liquid",
      "settings": {
        "custom_liquid": "<!-- Agregar Leaflet desde Shopify Assets -->\n<link rel=\"stylesheet\" href=\"{{ 'leaflet.css' | asset_url }}\">\n<script src=\"{{ 'leaflet.js' | asset_url }}\" defer></script>\n\n<style>\n    /* Contenedor general */\n    .contenedor {\n        display: flex;\n        flex-wrap: wrap;\n        gap: 20px;\n        padding: 20px;\n    }\n\n    /* Buscador y lista */\n    .buscador-container {\n        width: 30%;\n        min-width: 300px;\n        max-height: 500px;\n        overflow-y: auto;\n        padding: 20px;\n        border: 1px solid #ddd;\n        border-radius: 8px;\n        background: #fff;\n    }\n\n    #buscador {\n        width: 100%;\n        padding: 12px;\n        font-size: 16px;\n        text-align: center;\n        border: 1px solid #ccc;\n        border-radius: 5px;\n        outline: none;\n        margin-bottom: 15px;\n    }\n\n    /* Lista de distribuidores */\n    .lista-distribuidores {\n        list-style: none;\n        padding: 0;\n        margin: 0;\n        display: none;\n    }\n\n    .distribuidor {\n        display: flex;\n        align-items: center;\n        padding: 10px;\n        border-bottom: 1px solid #ddd;\n        cursor: pointer;\n        transition: background 0.2s;\n        background: #fff;\n        border-radius: 5px;\n        margin-bottom: 5px;\n    }\n\n    .distribuidor:hover {\n        background: #f9f9f9;\n    }\n\n    .distribuidor img {\n        width: 60px;\n        height: 60px;\n        border-radius: 5px;\n        margin-right: 10px;\n    }\n\n    .distribuidor .info {\n        flex-grow: 1;\n    }\n\n    .distribuidor strong {\n        display: block;\n        font-size: 16px;\n        margin-bottom: 3px;\n    }\n\n    .distribuidor span {\n        display: block;\n        font-size: 14px;\n        color: #666;\n    }\n\n    /* Mapa */\n    .map-container {\n        flex-grow: 1;\n        height: 500px;\n        border-radius: 8px;\n        position: relative;\n    }\n\n    #map {\n        width: 100%;\n        height: 100%;\n        border-radius: 8px;\n        background: #f3f3f3;\n    }\n\n    /* Mensaje de no resultados */\n    .no-resultados {\n        text-align: center;\n        font-size: 16px;\n        color: #666;\n        padding: 20px;\n        display: none;\n    }\n\n    /* Responsive */\n    @media screen and (max-width: 768px) {\n        .contenedor {\n            flex-direction: column;\n        }\n        .buscador-container {\n            width: 100%;\n        }\n        .map-container {\n            height: 400px;\n        }\n    }\n</style>\n\n<div class=\"contenedor\">\n    <!-- Buscador y lista de distribuidores -->\n    <div class=\"buscador-container\">\n        <input type=\"text\" id=\"buscador\" placeholder=\"Buscar distribuidores por ciudad...\">\n        <ul id=\"lista-distribuidores\" class=\"lista-distribuidores\"></ul>\n        <p id=\"no-resultados\" class=\"no-resultados\">No hay distribuidores disponibles.</p>\n    </div>\n\n    <!-- Mapa -->\n    <div class=\"map-container\">\n        <div id=\"map\"></div>\n    </div>\n</div>\n\n<script>\n    document.addEventListener(\"DOMContentLoaded\", function() {\n        setTimeout(function() { \n            if (typeof L === 'undefined') {\n                console.error(\"Leaflet.js no se ha cargado correctamente.\");\n                return;\n            }\n\n            var map = L.map('map').setView([19.4326, -99.1332], 6);\n            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n                attribution: '&copy; OpenStreetMap contributors'\n            }).addTo(map);\n\n            console.log(\"Mapa inicializado correctamente\");\n\n            var distribuidores = {{ shop.metaobjects.distribuidor.values | json }};\n            console.log(\"Distribuidores cargados:\", distribuidores);\n\n            if (!distribuidores || distribuidores.length === 0) {\n                console.error(\"No se encontraron distribuidores en Shopify.\");\n                return;\n            }\n\n            var listaDistribuidores = document.getElementById(\"lista-distribuidores\");\n            var noResultados = document.getElementById(\"no-resultados\");\n            var currentMarker = null;\n\n            function filtrarDistribuidores() {\n                var filtro = document.getElementById(\"buscador\").value.toLowerCase();\n                listaDistribuidores.innerHTML = \"\";\n                listaDistribuidores.style.display = \"none\";\n\n                if (filtro.length < 1) {\n                    noResultados.style.display = \"none\";\n                    return;\n                }\n\n                var hayResultados = false;\n\n                distribuidores.forEach(function(distribuidor) {\n                    var ciudad = distribuidor.ciudad.toLowerCase();\n                    if (ciudad.includes(filtro)) {\n                        hayResultados = true;\n                        listaDistribuidores.style.display = \"block\";\n\n                        // Convertir URL de la imagen correctamente para Shopify\n                        var logoUrl = \"{{ distribuidor.logo | image_url }}\";\n\n                        var li = document.createElement(\"li\");\n                        li.className = \"distribuidor\";\n                        li.setAttribute(\"data-direccion\", distribuidor.direccion);\n\n                        li.innerHTML = `\n                            <img src=\"${logoUrl}\" alt=\"${distribuidor.nombre}\">\n                            <div class=\"info\">\n                                <strong>${distribuidor.nombre}</strong>\n                                <span><b>Ciudad:</b> ${distribuidor.ciudad}</span>\n                                <span><b>Dirección:</b> ${distribuidor.direccion}</span>\n                                <span><b>Teléfono:</b> ${distribuidor.telefono}</span>\n                                <span><b>Horario:</b> ${distribuidor.horario}</span>\n                            </div>\n                        `;\n\n                        li.addEventListener(\"click\", function() {\n                            var direccion = distribuidor.direccion;\n                           fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(direccion)}`, {\n    method: \"GET\",\n    mode: \"cors\",\n    headers: {\n        \"Access-Control-Allow-Origin\": \"*\"\n    }\n})\n\n                                .then(response => response.json())\n                                .then(data => {\n                                    if (data.length > 0) {\n                                        var lat = parseFloat(data[0].lat);\n                                        var lng = parseFloat(data[0].lon);\n\n                                        if (currentMarker) {\n                                            map.removeLayer(currentMarker);\n                                        }\n\n                                        currentMarker = L.marker([lat, lng]).addTo(map)\n                                            .bindPopup(`\n                                                <div style='text-align: center;'>\n                                                    <img src=\"${logoUrl}\" width=\"60\" style=\"border-radius:5px;\"><br>\n                                                    <strong>${distribuidor.nombre}</strong><br>\n                                                    <b>Ciudad:</b> ${distribuidor.ciudad}<br>\n                                                    <b>Dirección:</b> ${direccion}<br>\n                                                    <b>Teléfono:</b> ${distribuidor.telefono}<br>\n                                                    <b>Horario:</b> ${distribuidor.horario}\n                                                </div>\n                                            `).openPopup();\n\n                                        map.setView([lat, lng], 15);\n                                    }\n                                });\n                        });\n\n                        listaDistribuidores.appendChild(li);\n                    }\n                });\n\n                noResultados.style.display = hayResultados ? \"none\" : \"block\";\n            }\n\n            document.getElementById(\"buscador\").addEventListener(\"keyup\", filtrarDistribuidores);\n\n        }, 1000);\n    });\n</script>",
        "layout": "t4s-container-wrap",
        "cl_bg": "",
        "cl_bg_gradient": "",
        "mg": ",,50px,",
        "pd": "",
        "mg_tb": "",
        "pd_tb": "",
        "mg_mb": ",,30px,",
        "pd_mb": ""
      }
    }
  },
  "order": [
    "heading",
    "main",
    "sidebar-page",
    "custom_liquid_CX46ap"
  ]
}
