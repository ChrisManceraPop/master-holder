/*
 * ------------------------------------------------------------
 * IMPORTANT: The contents of this file are auto-generated.
 *
 * This file may be updated by the Shopify admin theme editor
 * or related systems. Please exercise caution as any changes
 * made to this file may be overwritten.
 * ------------------------------------------------------------
 */
{
  "sections": {
    "heading": {
      "type": "heading-template",
      "settings": {
        "heading_fullwidth": false,
        "use_specify_image": true,
        "parallax": false,
        "color": "#000000",
        "overlay": 54,
        "padding": 50,
        "paddingmb": 50,
        "mg_b": 50,
        "mg_bmb": 50,
        "content_align": "t4s-text-center",
        "bg_pos": "center center",
        "bg_repeat": "no-repeat",
        "bg_size": "cover",
        "use_cus_css": false,
        "code_cus_css": ".SectionID {\nbackground-color:red\n}"
      }
    },
    "main": {
      "type": "main-page",
      "settings": {
        "layout": "t4s-container-wrap",
        "cl_bg": "",
        "cl_bg_gradient": "",
        "mg": "60px,,60px,",
        "pd": "",
        "mg_tb": "",
        "pd_tb": "",
        "mg_mb": ",,30px,",
        "pd_mb": ""
      }
    },
    "sidebar-page": {
      "type": "sidebar-page",
      "blocks": {
        "f69681ed-b75e-42de-be58-fdf73b3b7e08": {
          "type": "blog_cate",
          "settings": {
            "title": "Blog categories",
            "cat_link_list": "",
            "count": true
          }
        }
      },
      "block_order": [
        "f69681ed-b75e-42de-be58-fdf73b3b7e08"
      ],
      "disabled": true,
      "settings": {
        "enable_drawer": false,
        "space": 50,
        "size": "medium",
        "br_style": "none",
        "brcolor": "#222222",
        "sidebar_bdr": 5,
        "sidebar_pd": 10
      }
    },
    "custom_liquid_CX46ap": {
      "type": "custom-liquid",
      "settings": {
        "custom_liquid": "<!-- Agregar Leaflet desde Shopify Assets -->\n<link rel=\"stylesheet\" href=\"{{ 'leaflet.css' | asset_url }}\">\n<script src=\"{{ 'leaflet.js' | asset_url }}\" defer></script>\n\n<style>\n    /* Contenedor general */\n    .contenedor {\n        display: flex;\n        flex-wrap: wrap;\n        gap: 20px;\n        padding: 20px;\n    }\n\n    /* Buscador y lista */\n    .buscador-container {\n        width: 30%;\n        min-width: 300px;\n        max-height: 500px;\n        overflow-y: auto;\n        padding: 20px;\n        border: 1px solid #ddd;\n        border-radius: 8px;\n        background: #fff;\n    }\n\n    #buscador {\n        width: 100%;\n        padding: 10px;\n        font-size: 16px;\n        text-align: center;\n        border: 1px solid #ccc;\n        border-radius: 5px;\n        outline: none;\n        margin-bottom: 15px;\n    }\n\n    /* Lista de distribuidores */\n    .lista-distribuidores {\n        list-style: none;\n        padding: 0;\n    }\n\n    .distribuidor {\n        display: none;\n        padding: 15px;\n        border-bottom: 1px solid #eee;\n        cursor: pointer;\n    }\n\n    .distribuidor img {\n        width: 80px;\n        border-radius: 5px;\n        margin-bottom: 10px;\n    }\n\n    .distribuidor strong {\n        display: block;\n        font-size: 18px;\n        margin-top: 5px;\n    }\n\n    .distribuidor span {\n        display: block;\n        font-size: 14px;\n        color: #666;\n    }\n\n    /* Mapa */\n    .map-container {\n        flex-grow: 1;\n        height: 500px;\n        border-radius: 8px;\n        position: relative;\n    }\n\n    #map {\n        width: 100%;\n        height: 100%;\n        border-radius: 8px;\n        background: #f3f3f3;\n    }\n\n    /* Responsive */\n    @media screen and (max-width: 768px) {\n        .contenedor {\n            flex-direction: column;\n        }\n        .buscador-container {\n            width: 100%;\n        }\n        .map-container {\n            height: 400px;\n        }\n    }\n</style>\n\n<div class=\"contenedor\">\n    <!-- Buscador y lista de distribuidores -->\n    <div class=\"buscador-container\">\n        <input type=\"text\" id=\"buscador\" placeholder=\"Buscar distribuidores por ciudad...\" onkeyup=\"filtrarDistribuidores()\">\n        <ul id=\"lista-distribuidores\" class=\"lista-distribuidores\">\n            {% for distribuidor in shop.metaobjects.distribuidor.values %}\n                {% assign ciudad = distribuidor.ciudad | downcase %}\n                <li class=\"distribuidor\" data-ciudad=\"{{ ciudad }}\" data-direccion=\"{{ distribuidor.direccion }}\">\n                    <img src=\"{{ distribuidor.logo | image_url }}\" alt=\"{{ distribuidor.nombre }}\"><br>\n                    <strong>{{ distribuidor.nombre }}</strong>\n                    <span><b>Ciudad:</b> {{ distribuidor.ciudad }}</span>\n                    <span><b>Dirección:</b> {{ distribuidor.direccion }}</span>\n                    <span><b>Teléfono:</b> {{ distribuidor.telefono }}</span>\n                    <span><b>Horario:</b> {{ distribuidor.horario }}</span>\n                </li>\n            {% endfor %}\n        </ul>\n    </div>\n\n    <!-- Mapa -->\n    <div class=\"map-container\">\n        <div id=\"map\"></div>\n    </div>\n</div>\n\n<script>\n    document.addEventListener(\"DOMContentLoaded\", function() {\n        setTimeout(function() { \n            if (typeof L === 'undefined') {\n                console.error(\"Leaflet.js no se ha cargado correctamente.\");\n                return;\n            }\n\n            // Inicializar el mapa centrado en México\n            var map = L.map('map').setView([19.4326, -99.1332], 6);\n            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n                attribution: '&copy; OpenStreetMap contributors'\n            }).addTo(map);\n\n            console.log(\"Mapa inicializado correctamente\");\n\n            var markers = [];\n            var listaDistribuidores = document.getElementById(\"lista-distribuidores\");\n            var items = document.getElementsByClassName(\"distribuidor\");\n\n            function filtrarDistribuidores() {\n                var filtro = document.getElementById(\"buscador\").value.toLowerCase();\n                console.log(\"Buscando:\", filtro);\n\n                markers.forEach(marker => map.removeLayer(marker));\n                markers = [];\n\n                var hayResultados = false;\n\n                for (var i = 0; i < items.length; i++) {\n                    var ciudad = items[i].getAttribute(\"data-ciudad\");\n                    var direccion = items[i].getAttribute(\"data-direccion\");\n\n                    if (ciudad.includes(filtro) && filtro !== \"\") {\n                        items[i].style.display = \"block\";\n                        hayResultados = true;\n\n                        // **Obtener coordenadas desde Google Maps**\n                        fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(direccion)}`)\n                            .then(response => response.json())\n                            .then(data => {\n                                if (data.length > 0) {\n                                    var lat = parseFloat(data[0].lat);\n                                    var lng = parseFloat(data[0].lon);\n\n                                    // Agregar marcador al mapa\n                                    var marker = L.marker([lat, lng]).addTo(map)\n                                        .bindPopup(`\n                                            <div style='text-align: center;'>\n                                                <img src=\"${items[i].querySelector(\"img\").src}\" width=\"60\" style=\"border-radius:5px;\"><br>\n                                                <strong>${items[i].querySelector(\"strong\").textContent}</strong><br>\n                                                ${items[i].querySelector(\"span:nth-child(3)\").textContent}<br>\n                                                <b>Dirección:</b> ${items[i].querySelector(\"span:nth-child(4)\").textContent}<br>\n                                                <b>Teléfono:</b> ${items[i].querySelector(\"span:nth-child(5)\").textContent}<br>\n                                                <b>Horario:</b> ${items[i].querySelector(\"span:nth-child(6)\").textContent}\n                                            </div>\n                                        `);\n                                    markers.push(marker);\n\n                                    // Ajustar zoom\n                                    if (hayResultados) {\n                                        var group = new L.featureGroup(markers);\n                                        map.fitBounds(group.getBounds(), { padding: [50, 50] });\n                                    }\n                                }\n                            });\n                    } else {\n                        items[i].style.display = \"none\";\n                    }\n                }\n            }\n        }, 1000);\n    });\n</script>",
        "layout": "t4s-container-wrap",
        "cl_bg": "",
        "cl_bg_gradient": "",
        "mg": ",,50px,",
        "pd": "",
        "mg_tb": "",
        "pd_tb": "",
        "mg_mb": ",,30px,",
        "pd_mb": ""
      }
    }
  },
  "order": [
    "heading",
    "main",
    "sidebar-page",
    "custom_liquid_CX46ap"
  ]
}
